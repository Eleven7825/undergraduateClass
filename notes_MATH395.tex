\documentclass[10pt]{article}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{url}
\usepackage{amsthm}
\usepackage{color}
%\usepackage{stmaryrd}
\usepackage{graphicx}

\newtheorem{mydef}{Definition}
\newtheorem{mylem}{Lemma}
\newtheorem{myass}{Assumption}
\newtheorem{myprop}{Proposition}
\newtheorem{mycor}{Corollary}
\newtheorem{myrem}{Remark}
\newtheorem{mythm}{Theorem}

\newcommand{\bs}[1]{{\boldsymbol #1}}
\newcommand{\hot}[1]{\textcolor{red}{#1}} 
\newcommand{\bsxi}{\bs \xi}

\usepackage[margin=2.5cm]{geometry}
\begin{document}
\title{Mathematical modeling in science, engineering, and economics}
\maketitle

\tableofcontents

\newpage
\section{Network of springs and dashpots}

\subsection{Equations of motion}
We consider a network of springs and dashpots which connect some masses.  Define the following physical parameters:
\begin{align*}
M_k &= \text{mass at node }k \\
S_{jk} &= \text{spring constant between node $j$ and node $k$} \\
D_{jk} &= \text{dashpot constant between node $j$ and node $k$} \\
R^0_{jk} &= \text{resting length of spring between node $j$ and node $k$} 
\end{align*}
For a mass $k$, let $N(k)$ be the index set of masses which are connected to mass $k$.  Let ${\bf X}_k$ and ${\bf U}_k$ be the position and velocity vectors of mass $k$ respectively.  The equations of motion for this network of masses connected by springs and dashpots are
\begin{align}
\label{eq:mot1}
M_k \frac{d {\bf U}_k}{dt} &= \sum_{j \in N(k)} T_{jk} \frac{{\bf X}_j - {\bf X}_k}{\| {\bf X}_j - {\bf X}_k \|} \\
\label{eq:mot2}
\frac{d {\bf X}_k}{dt} &= {\bf U}_k \\
\label{eq:mot3}
T_{jk} &= S_{jk} \left( \|{\bf X}_j - {\bf X}_k\| - R^0_{jk} \right) + D_{jk} \frac{d}{dt} \|{\bf X}_j - {\bf X}_k \|
\end{align}
Equation \eqref{eq:mot1} is a statement of force balance.  Notice the total force on mass $k$ is the sum of forces which each point in the direction from mass $j$ to $k$, given by the unit vector $\frac{{\bf X}_j - {\bf X}_k}{\| {\bf X}_j - {\bf X}_k \|}$, with magnitude $T_{jk}$.  Equation \eqref{eq:mot2} states simply the definition of velocity for mass $k$.  The last equation is the force magnitude, broken into the sum of a spring force magnitude depending on its stretching or compression from its rest length $R_{jk}^0$, and a dashpot force magnitude proportional to the time rate of change of this stretching or compression.

We can simplify the dashpot force magnitude in \eqref{eq:mot3} by considering the time derivative of the square of the displacement and using the chain rule:
\begin{align*}
\frac{d}{dt} \Big(\|{\bf X}_j - {\bf X}_k\|^2\Big) = 2 \|{\bf X}_j - {\bf X}_k\| \, \Big( \frac{d}{dt} \|{\bf X}_j - {\bf X}_k \| \Big).
\end{align*}  
By the product rule, the left hand side becomes:
\begin{align*}
\frac{d}{dt} \Big(\|{\bf X}_j - {\bf X}_k\|^2\Big) = 2({\bf X}_j - {\bf X}_k) \cdot ({\bf U}_j - {\bf U}_k)
\end{align*}
Combining these two equations gives a formula for the time derivative of the displacement:
\begin{align*}
\frac{d}{dt} \|{\bf X}_j - {\bf X}_k \| = \frac{{\bf X}_j - {\bf X}_k}{\|{\bf X}_j - {\bf X}_k\|} \cdot ({\bf U}_j - {\bf U}_k)
\end{align*}
We can then equivalently express the equations of motions as: 
\begin{align}
\label{eq:mot4}
M_k \frac{d {\bf U}_k}{dt} &= \sum_{j \in N(k)} T_{jk} \frac{{\bf X}_j - {\bf X}_k}{\| {\bf X}_j - {\bf X}_k \|} \\
\label{eq:mot5}
\frac{d {\bf X}_k}{dt} &= {\bf U}_k \\
\label{eq:mot6}
T_{jk} &= S_{jk} \left( \|{\bf X}_j - {\bf X}_k\| - R^0_{jk} \right) + D_{jk} \frac{{\bf X}_j - {\bf X}_k}{\|{\bf X}_j - {\bf X}_k\|} \cdot ({\bf U}_j - {\bf U}_k)
\end{align}
Notice that the force magnitude for the dashpot involves the component of the velocity in the direction of spring, which seems to make sense!

The next question we need to answer is how to approximate these equations on a computer.  We are modeling a system which involves space and time, but since the masses are already discrete spatial entities, we just need to worry about approximating the temporal dynamics numerically.  To do this, pick some small, discrete timestep $\Delta t > 0$.  For the {\bf \em forward Euler} method, we use an approximation to the time derivative of the form:
\begin{align*}
\frac{d {\bf U}}{dt}\Big|_{t + \Delta t} \approx \frac{{\bf U}(t+\Delta t ) - {\bf U}(t)}{\Delta t},
\end{align*}
and evaluate the right hand side of the equations of motion at time $t$.  Explicitly, this becomes:
\begin{align*}
M_k \frac{{\bf U}_k(t + \Delta t) - {\bf U}_k(t)}{\Delta t} &= \sum_{j \in N(k)} T_{jk}(t) \frac{{\bf X}_j(t) - {\bf X}_k(t)}{\| {\bf X}_j(t) - {\bf X}_k(t) \|} \\
\frac{{\bf X}_k(t + \Delta t) - {\bf X}_k(t)}{\Delta t} &= {\bf U}_k(t + \Delta t) \\
T_{jk}(t) &= S_{jk} \left( \|{\bf X}_j(t) - {\bf X}_k(t)\| - R^0_{jk} \right) + D_{jk} \frac{{\bf X}_j(t) - {\bf X}_k(t)}{\|{\bf X}_j(t) - {\bf X}_k(t)\|} \cdot ({\bf U}_j(t) - {\bf U}_k(t))
\end{align*}
These equations allow us to first compute ${\bf U}_k(t + \Delta t)$ from the velocities and positions at time $t$, and then use this velocity to compute ${\bf X}_k(t + \Delta t)$. 

We can alternatively evaluate the right hand of the equations of motion at time $t + \Delta t$.  This approach is the {\bf \em backward Euler} method.  To state this method, we just shift the time by $\Delta t$:
\begin{align*}
M_k \frac{{\bf U}_k(t) - {\bf U}_k(t- \Delta t)}{\Delta t} &= \sum_{j \in N(k)} T_{jk}(t) \frac{{\bf X}_j(t) - {\bf X}_k(t)}{\| {\bf X}_j(t) - {\bf X}_k(t) \|} \\
\frac{{\bf X}_k(t) - {\bf X}_k(t - \Delta t)}{\Delta t} &= {\bf U}_k(t) \\
T_{jk}(t) &= S_{jk} \left( \|{\bf X}_j(t) - {\bf X}_k(t)\| - R^0_{jk} \right) + D_{jk} \frac{{\bf X}_j(t) - {\bf X}_k(t)}{\|{\bf X}_j(t) - {\bf X}_k(t)\|} \cdot ({\bf U}_j(t) - {\bf U}_k(t))
\end{align*}
Backward Euler is more complex to implement because the unknowns appear on the right and left hand side of the discretized equations of motion.  This setup results in a nonlinear system to be solved at every timestep, and we can use for example Newton's method to solve this.

\subsection{Modeling the interaction with the ground}

The ground can be generically modeled as a one--dimensional curve in two dimensions, or a two--dimensional surface in three dimensions.  For example, a planar surface for the ground can be specified as:
\begin{align*}
a \, X_1 + b\, X_2 + c \,X_3 = 0
\end{align*}
with normal vector ${\bf n} = [a,b,c]^T$.  A more general equation for the ground takes the form:
\begin{align*}
H(X_1,X_2,X_3) = H({\bf X}) = 0.
\end{align*}
To model some sort of force that the ground exerts on each mass, we need to know when we are above and below it.  For a given mass at location ${\bf X}$ in $\mathbb{R}^2$ or $\mathbb{R}^3$, we say it is {\em above the ground} if $H({\bf X}) > 0$ and {\em below the ground} if $H({\bf X}) < 0$.  The force that the ground exerts on this mass will only be active when the mass is below the ground.

As a modeling choice, we make the magnitude of this force proportional to the distance from the mass to the ground.  Set the mass' location below the ground to be ${\bf X}^0$, and take ${\bf X}$ to be some point on the ground, i.e. $H({\bf X}) = 0$.  Let's take a Taylor expansion:
\begin{align}
\label{eq:te1}
H({\bf X}) - H({\bf X}^0) = \nabla H({\bf X}^0) \cdot ({\bf X} - {\bf X}^0) + O(\|{\bf X} - {\bf X}^0\|^2) 
\end{align}  

A formula to find the distance from a mass at ${\bf X}^0$ to the ground would be the smallest distance $\|{\bf X} - {\bf X}^0\|$ such that $H({\bf X}) = 0$.  This can be stated as an optimization problem:
\begin{align*}
\text{minimize } &\|{\bf X} - {\bf X}^0\| \\
\text{such that } &H({\bf X}) = 0.
\end{align*}
We can equivalently minimize the squared distance $\|{\bf X} - {\bf X}^0\|^2$, which is sometime easier to work with, so let's solve:
\begin{align*}
\text{minimize } &\|{\bf X} - {\bf X}^0\|^2 \\
\text{such that } &H({\bf X}) = 0.
\end{align*}

To solve this optimization problem, it is useful to express the vector ${\bf X} - {\bf X}^0$ in a new basis containing ${\bf V}_1 = \nabla H({\bf X}^0) / \|  \nabla H({\bf X}^0) \|$.  Let's assume we are in $\mathbb{R}^3$ and we pick ${\bf V}_2$ and ${\bf V}_3$ so that $\{ {\bf V}_1,  {\bf V}_2,  {\bf V}_3 \}$ forms an orthonormal basis.  Then we can write:
\begin{align*}
{\bf X} - {\bf X}^0 = \sum_{i=1}^3 \, \Big(({\bf X} - {\bf X}^0) \cdot {\bf V}_i \Big) \, {\bf V}_i, 
\end{align*} 
and
\textbf{\begin{align*}
\|{\bf X} - {\bf X}^0\|^2 = ({\bf X} - {\bf X}^0) \cdot ({\bf X} - {\bf X}^0) = \sum_{i=1}^3 \, |({\bf X} - {\bf X}^0) \cdot {\bf V}_i|^2. 
\end{align*} }
Using ${\bf V}_1 = \nabla H({\bf X}^0) / \|  \nabla H({\bf X}^0) \|$, we can express:
\begin{align}
\label{eq:te2}
\|{\bf X} - {\bf X}^0\|^2 = \left(\frac{({\bf X} - {\bf X}^0) \cdot \nabla H({\bf X}^0)}{\|  \nabla H({\bf X}^0) \|} \right)^2 +  \sum_{i=2}^3 \, |({\bf X} - {\bf X}^0) \cdot {\bf V}_i|^2. 
\end{align} 
Now, use \eqref{eq:te1} to simplify the first term of \eqref{eq:te2}, where we drop the higher order terms in the expansion, and use the constraint that $H({\bf X}) = 0$.  Then the optimization problem can be ``approximated'' by this new one:
\begin{align*}
\text{minimize }&\left(\frac{H({\bf X}^0)}{\|  \nabla H({\bf X}^0) \|}\right)^2 +  \sum_{i=2}^3 \, |({\bf X} - {\bf X}^0) \cdot {\bf V}_i|^2 \\
\text{such that }&H({\bf X}) = 0.
\end{align*} 
Now, try to argue geometrically that we can pick ${\bf X} = {\bf X}^\text{opt}$ so that $H({\bf X}^\text{opt}) = 0$ and $({\bf X}^\text{opt} - {\bf X}^0) \cdot {\bf V}_i = 0$ for $i = 2, 3$.  In fact, we can pick ${\bf X}^\text{opt}$ so that ${\bf X}^\text{opt} - {\bf X}^0$ is parallel to ${\bf V}_1$.  This would be the solution to our new optimization problem, with the minimum distance given by:
\begin{align*}
\| {\bf X}^\text{opt} - {\bf X}^0 \| = \frac{-H({\bf X}^0)}{\|  \nabla H({\bf X}^0) \|}.
\end{align*} 
In summary, we use $-H({\bf X}^0) /\|  \nabla H({\bf X}^0)\|$ to approximate the distance from ${\bf X}^0$ to the ground.  The force from the ground will be proportional to this with some constant $S_\text{ground}$, in the direction of the normal vector to the surface $H({\bf X}) = H({\bf X}^0)$ evaluated at ${\bf X}^0$, which is precisely ${\bf V}_1$.  Putting all this together, the force from the ground is
\begin{align*}
{\bf F}_\text{ground}({\bf X}) = 
\begin{cases}
0 & \text{if }H({\bf X}) \geq 0 \\
-S_\text{ground} \frac{H({\bf X})}{\|\nabla H({\bf X})\|} \frac{\nabla H({\bf X})}{\|\nabla H({\bf X})\|} & \text{if }H({\bf X}) < 0
\end{cases}
\end{align*}

We now wish to describe the effect of friction from the ground.  For this we need the tangential velocity ${\bf U}^{(\text{tan})}$ which can be obtained by projecting the velocity onto the vectors spanning the tangent plane to the ground.  Generically, the projection onto the space of vectors orthogonal to some unit vector ${\bf V}$ is 
\begin{align*}
\mathbb{I} - {\bf V} {\bf V}^T,
\end{align*}
where $\mathbb{I}$ is the identity matrix.  Note that we already have the normal vector at point ${\bf X}$ to the ground, given by  $H({\bf X}) / \|\nabla H({\bf X})\|$.  So, the projection onto the tangent plane to the ground at point ${\bf X}$ is given by the matrix
\begin{align*}
\mathbb{I} -\frac{\nabla H({\bf X})}{\|\nabla H({\bf X})\|}\frac{\nabla H({\bf X})^T}{\|\nabla H({\bf X})\|},
\end{align*}
and then the tangential velocity can be computed by applying this matrix to the velocity vector:
\begin{align*}
{\bf U}^{(\text{tan})} = {\bf U} -\frac{\nabla H({\bf X})}{\|\nabla H({\bf X})\|}\frac{\nabla H({\bf X}) \cdot {\bf U}}{\|\nabla H({\bf X})\|}.
\end{align*}


\end{document}
